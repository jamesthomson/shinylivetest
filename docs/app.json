[{"name":"server.R","content":"function(input, output, session) {\r\n  \r\n  # Combine the selected variables into a new data frame\r\n  selectedData <- reactive({\r\n    iris[, c(input$xcol, input$ycol)]\r\n  })\r\n  \r\n  clusters <- reactive({\r\n    kmeans(selectedData(), input$clusters)\r\n  })\r\n  \r\n  output$plot1 <- renderPlot({\r\n    palette(c(\"#E41A1C\", \"#377EB8\", \"#4DAF4A\", \"#984EA3\",\r\n              \"#FF7F00\", \"#FFFF33\", \"#A65628\", \"#F781BF\", \"#999999\"))\r\n    \r\n    par(mar = c(5.1, 4.1, 0, 1))\r\n    plot(selectedData(),\r\n         col = clusters()$cluster,\r\n         pch = 20, cex = 3)\r\n    points(clusters()$centers, pch = 4, cex = 4, lwd = 4)\r\n  })\r\n  \r\n}","type":"text"},{"name":"ui.R","content":"# k-means only works with numerical variables,\r\n# so don't give the user the option to select\r\n# a categorical variable\r\nvars <- setdiff(names(iris), \"Species\")\r\n\r\npageWithSidebar(\r\n  headerPanel('Iris k-means clustering'),\r\n  sidebarPanel(\r\n    selectInput('xcol', 'X Variable', vars),\r\n    selectInput('ycol', 'Y Variable', vars, selected = vars[[2]]),\r\n    numericInput('clusters', 'Cluster count', 3, min = 1, max = 9)\r\n  ),\r\n  mainPanel(\r\n    plotOutput('plot1')\r\n  )\r\n)","type":"text"}]
